"use strict";(()=>{var e={};e.id=988,e.ids=[988],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9801:e=>{e.exports=require("os")},4175:e=>{e.exports=require("tty")},1764:e=>{e.exports=require("util")},2761:e=>{e.exports=require("node:async_hooks")},2033:e=>{e.exports=require("node:module")},4710:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>I,patchFetch:()=>f,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>E,staticGenerationAsyncStorage:()=>p});var n={};r.r(n),r.d(n,{POST:()=>u});var o=r(9303),s=r(8716),i=r(670),a=r(7070),l=r(1202),g=r(9435);async function u(e){let t=Date.now();try{l.k.log(1,"Itinerary generation request received","route.ts","POST");let{formData:r,sessionId:n,options:o={}}=await e.json();if(l.k.log(2,"Request parsed","route.ts","POST",{hasFormData:!!r,sessionId:n||"not-provided",options:o}),!r)return l.k.error(3,"Missing formData in request","route.ts","POST","ValidationError: formData is required"),a.NextResponse.json({error:"formData is required",success:!1},{status:400});let s=n||`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;l.k.log(4,"Session ID resolved","route.ts","POST",{sessionId:s}),l.k.log(5,"Form data received","route.ts","POST",{location:r.location,adults:r.adults,budget:r.budget,currency:r.currency,dataSize:JSON.stringify(r).length});let i=`workflow_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;l.k.log(25,"Workflow ID generated","route.ts","POST",{workflowId:i});let u=new Date(Date.now()+18e4).toISOString();l.k.log(26,"Estimated completion calculated","route.ts","POST",{estimatedCompletion:u});let c=`${e.nextUrl.origin}/api/itinerary/status/${i}`;l.k.log(27,"Status endpoint generated","route.ts","POST",{statusEndpoint:c}),l.k.log(28,"Workflow enqueue starting","route.ts","POST",{workflowId:i});try{await g.$C.send({name:"itinerary.generate.requested",data:{formData:r,sessionId:s,workflowId:i}}),l.k.log(29,"Workflow enqueued successfully","route.ts","POST",{workflowId:i})}catch(e){return l.k.error(30,"Failed to enqueue workflow","route.ts","POST",e instanceof Error?e.message:String(e)),a.NextResponse.json({error:"Failed to start workflow",success:!1},{status:500})}l.k.log(33,"Workflow state storage simulation","route.ts","POST",{workflowId:i,status:"queued",message:"Redis storage would happen here"});let d=Date.now()-t;return l.k.log(34,"API request completed successfully","route.ts","POST",{workflowId:i,sessionId:s,processingTimeMs:d}),a.NextResponse.json({success:!0,workflowId:i,estimatedCompletion:u,statusEndpoint:c,message:"Itinerary generation started successfully",sessionId:s})}catch(r){let e=Date.now()-t;return l.k.error(35,"Unexpected error in itinerary generation","route.ts","POST",r instanceof Error?r:String(r),{processingTimeMs:e}),a.NextResponse.json({error:"Internal server error",success:!1,message:"An unexpected error occurred. Please try again."},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/itinerary/generate/route",pathname:"/api/itinerary/generate",filename:"route",bundlePath:"app/api/itinerary/generate/route"},resolvedPagePath:"C:\\Users\\raze0\\Documents\\vercel_deploy\\hylo00_original\\src\\app\\api\\itinerary\\generate\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:d,staticGenerationAsyncStorage:p,serverHooks:E}=c,I="/api/itinerary/generate/route";function f(){return(0,i.patchFetch)({serverHooks:E,staticGenerationAsyncStorage:p})}},9435:(e,t,r)=>{r.d(t,{$C:()=>a});var n=r(2745),o=r(1202),s=r(2584);let i=null,a=function(){if(i)return i;try{let e=(0,s.e)();return i=new n.K({id:"hylo00-itinerary",name:"Hylo00 AI Itinerary Generator",eventKey:e.inngest.eventKey,signingKey:e.inngest.signingKey,baseUrl:"development"===e.app.nodeEnv?"http://localhost:8288":void 0,logger:{debug:(e,...t)=>{t.length>0?o.k.log(0,`INNGEST_DEBUG: ${e}`,"client.ts","debug",{args:t}):o.k.log(0,`INNGEST_DEBUG: ${e}`,"client.ts","debug")},info:(e,...t)=>{t.length>0?o.k.log(0,`INNGEST_INFO: ${e}`,"client.ts","info",{args:t}):o.k.log(0,`INNGEST_INFO: ${e}`,"client.ts","info")},warn:(e,...t)=>{t.length>0?o.k.log(0,`INNGEST_WARN: ${e}`,"client.ts","warn",{args:t}):o.k.log(0,`INNGEST_WARN: ${e}`,"client.ts","warn")},error:(e,...t)=>{t.length>0?o.k.log(0,`INNGEST_ERROR: ${e}`,"client.ts","error",{args:t}):o.k.log(0,`INNGEST_ERROR: ${e}`,"client.ts","error")}}}),o.k.log(0,"INNGEST_CLIENT_INITIALIZED","client.ts","getInngestClient",{clientId:"hylo00-itinerary",hasEventKey:!!e.inngest.eventKey,hasSigningKey:!!e.inngest.signingKey,isDevelopment:"development"===e.app.nodeEnv}),i}catch(e){throw o.k.error(0,"INNGEST_CLIENT_INITIALIZATION_FAILED","client.ts","getInngestClient",e instanceof Error?e:String(e)),e}}()},2584:(e,t,r)=>{r.d(t,{e:()=>s});var n=r(1202);let o=null;function s(){if(o)return o;try{return n.k.log(23,"Loading itinerary configuration","itinerary-config.ts","getItineraryConfig"),function(){let e=["GROQ_API_KEY","XAI_API_KEY","TAVILY_API_KEY","EXA_API_KEY","SERP_API_KEY","INNGEST_EVENT_KEY","INNGEST_SIGNING_KEY","KV_REST_API_URL","KV_REST_API_TOKEN"].filter(e=>!process.env[e]);if(e.length>0){let t=`Missing environment variables (using fallbacks): ${e.join(", ")}`;n.k.error(23,"Configuration validation failed","itinerary-config.ts","validateRequiredEnvVars",t)}else n.k.log(23,"Required environment variables validated","itinerary-config.ts","validateRequiredEnvVars")}(),o={groq:{apiKey:process.env.GROQ_API_KEY},xai:{apiKey:process.env.XAI_API_KEY},tavily:{apiKey:process.env.TAVILY_API_KEY},exa:{apiKey:process.env.EXA_API_KEY},serp:{apiKey:process.env.SERP_API_KEY},inngest:{eventKey:process.env.INNGEST_EVENT_KEY,signingKey:process.env.INNGEST_BRANCH_SIGNING_KEY||process.env.INNGEST_SIGNING_KEY},redis:{restUrl:process.env.KV_REST_API_URL,restToken:process.env.KV_REST_API_TOKEN},app:{nodeEnv:function(e){let t="development";return e&&["development","preview","production"].includes(e)?e:(n.k.warn(23,"Invalid NODE_ENV, using default","itinerary-config.ts","parseNodeEnv",`Invalid value: ${e}, using: ${t}`),t)}("production"),logLevel:function(e){let t="info";return e&&["silent","error","warn","info","debug"].includes(e)?e:(n.k.warn(23,"Invalid ITINERARY_LOG_LEVEL, using default","itinerary-config.ts","parseLogLevel",`Invalid value: ${e}, using: ${t}`),t)}(process.env.ITINERARY_LOG_LEVEL),cacheTtlMinutes:function(e){if(!e)return 120;let t=parseInt(e,10);return isNaN(t)||t<5||t>1440?(n.k.warn(23,"Invalid ITINERARY_CACHE_TTL_MINUTES, using default","itinerary-config.ts","parseCacheTtl",`Invalid value: ${e}, using: 120`),120):t}(process.env.ITINERARY_CACHE_TTL_MINUTES)},flags:{enableDetailedLogging:!0,enableDataCleansing:!0,allowPdfExport:!0,allowEmailDraft:!0,mapsFallbackMode:function(e){let t="static";return e&&["static","placeholder","hidden"].includes(e)?e:(n.k.warn(23,"Invalid maps fallback mode, using default","itinerary-config.ts","parseMapsFallbackMode",`Invalid value: ${e}, using: ${t}`),t)}(process.env.ITINERARY_MAPS_FALLBACK_MODE)}},n.k.log(23,"Itinerary configuration loaded successfully","itinerary-config.ts","getItineraryConfig",{nodeEnv:o.app.nodeEnv,logLevel:o.app.logLevel,cacheTtlMinutes:o.app.cacheTtlMinutes,mapsFallbackMode:o.flags.mapsFallbackMode}),o}catch(e){throw n.k.error(23,"Failed to load itinerary configuration","itinerary-config.ts","getItineraryConfig",e instanceof Error?e:String(e)),e}}},1202:(e,t,r)=>{var n,o,s,i,a;r.d(t,{k:()=>g}),function(e){e.USD="USD",e.EUR="EUR",e.GBP="GBP",e.CAD="CAD",e.AUD="AUD"}(n||(n={})),function(e){e.TOTAL="total",e.PER_PERSON="per-person"}(o||(o={})),function(e){e.PENDING="pending",e.PROCESSING="processing",e.COMPLETE="complete",e.ERROR="error"}(s||(s={})),function(e){e.SUCCESS="Success",e.ERROR="Error",e.WARNING="Warning"}(i||(i={})),function(e){e.HIGH="High",e.MEDIUM="Medium",e.LOW="Low"}(a||(a={}));class l{static instance;logLevel;logs=[];maxLogs=1e3;constructor(){this.logLevel=process.env.ITINERARY_LOG_LEVEL||"info"}static getInstance(){return l.instance||(l.instance=new l),l.instance}shouldLog(e){let t=["silent","error","warn","info","debug"],r=t.indexOf(this.logLevel);return t.indexOf(e)<=r}log(e,t,r,n,o={},s,a=i.SUCCESS){if(!this.shouldLog("info"))return;let l={stepNumber:e,action:t,fileName:r,functionName:n,timestamp:new Date().toISOString(),data:o,...void 0!==s&&{duration:s},status:a};this.logs.push(l),this.logs.length>this.maxLogs&&this.logs.shift();try{console.log(`Step ${e}: ${t} in ${r} - ${n}`,l)}catch(r){console.error(`Step ${e}: Logging failed for ${t}`,{error:r instanceof Error?r.message:String(r)})}}error(e,t,r,n,o,s={}){if(!this.shouldLog("error"))return;let a=o instanceof Error?o.message:o;this.log(e,t,r,n,{...s,error:a},void 0,i.ERROR)}warn(e,t,r,n,o,s={}){this.shouldLog("warn")&&this.log(e,t,r,n,{...s,warning:o},void 0,i.WARNING)}debug(e,t,r,n,o={}){this.shouldLog("debug")&&this.log(e,`DEBUG: ${t}`,r,n,o,void 0,i.SUCCESS)}getLogs(){return[...this.logs]}clearLogs(){this.logs=[]}}let g=l.getInstance()}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[948,972,745],()=>r(4710));module.exports=n})();