"use strict";(()=>{var e={};e.id=180,e.ids=[180],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},578:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>I,patchFetch:()=>m,requestAsyncStorage:()=>f,routeModule:()=>E,serverHooks:()=>y,staticGenerationAsyncStorage:()=>v});var a={};r.r(a),r.d(a,{GET:()=>g});var i=r(9303),n=r(8716),s=r(670),o=r(7070),l=r(1202),c=r(2584);let u=["grok-4-fast-reasoning","grok-4-fast-non-reasoning"],h=["healthy","degraded","error"];async function g(e){let t=Date.now();try{l.k.log(1,"AI health check request received","ai/health/route.ts","GET");let r=(0,c.e)();l.k.log(2,"Checking xAI service health","ai/health/route.ts","GET",{apiKeyPresent:!!r.xai.apiKey});let a=await p(r.xai.apiKey);l.k.log(3,"xAI health check completed","ai/health/route.ts","GET",a);let i=function(e){if(!e)return{};let t={};for(let r of e.split(",")){let e=r.trim();if(!e)continue;let[a,i]=e.split("=");if(!a||!i)continue;let n=a.trim().toLowerCase(),[s,o]=i.split(":").map(e=>e.trim());if(!s)continue;let l=s.toLowerCase();if(!h.includes(l))continue;let c={status:l};if(o){let e=Number(o);Number.isFinite(e)&&e>=0&&(c.latency=e)}t[n]=c}return t}(e.nextUrl.searchParams.get("simulate"));l.k.log(4,"Checking Groq AI service health","ai/health/route.ts","GET",{overrideRequested:!!i.groq});let n=await d("groq",100,i.groq);l.k.log(5,"Groq health check completed","ai/health/route.ts","GET",n),l.k.log(6,"Checking Tavily research service health","ai/health/route.ts","GET",{overrideRequested:!!i.tavily});let s=await d("tavily",150,i.tavily);l.k.log(7,"Tavily health check completed","ai/health/route.ts","GET",s),l.k.log(8,"Checking Exa research service health","ai/health/route.ts","GET",{overrideRequested:!!i.exa});let u=await d("exa",120,i.exa);l.k.log(9,"Exa health check completed","ai/health/route.ts","GET",u);let g={xai:a,groq:n,tavily:s,exa:u},E=Object.values(g).every(e=>"healthy"===e.status);l.k.log(10,"Overall health assessment completed","ai/health/route.ts","GET",{healthy:E,servicesCount:Object.keys(g).length});let f=Date.now()-t;return l.k.log(11,"AI health check completed successfully","ai/health/route.ts","GET",{healthy:E,processingTimeMs:f}),o.NextResponse.json({healthy:E,services:g})}catch(r){let e=Date.now()-t;return l.k.error(12,"Unexpected error in AI health check","ai/health/route.ts","GET",r instanceof Error?r:String(r),{processingTimeMs:e}),o.NextResponse.json({healthy:!1,services:{xai:{status:"error",latency:0},groq:{status:"error",latency:0},tavily:{status:"error",latency:0},exa:{status:"error",latency:0}},error:"Health check failed"},{status:503})}}async function d(e,t,r){return r?{status:r.status,latency:Math.round(r.latency??t),overrideApplied:!0,simulatedService:e}:{status:"healthy",latency:Math.round(t+30*Math.random()),overrideApplied:!1,simulatedService:e}}async function p(e){if(!e)return{status:"missing",latency:0,message:"XAI_API_KEY is not configured"};let t=Date.now(),r=new AbortController,a=setTimeout(()=>r.abort(),5e3);try{let a=await fetch("https://api.x.ai/v1/models",{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json",Accept:"application/json"},cache:"no-store",signal:r.signal}),i=Date.now()-t;if(!a.ok){let e;try{e=await a.text()}catch{e=a.statusText}return{status:401===a.status||403===a.status?"unauthorized":"error",latency:i,message:e?.slice(0,300)??"Unexpected response from xAI",statusCode:a.status}}let n=null;try{n=await a.json()}catch{}let s=Array.isArray(n?.data)?n.data:[];s.slice(0,3).map(e=>e?.id??e?.name).filter(e=>"string"==typeof e);let o=s.map(e=>"string"==typeof e?e:e?.id||e?.name).filter(e=>"string"==typeof e),l=u.filter(e=>!o.includes(e)),c=0===l.length,h=Array.from(new Set([...u.filter(e=>o.includes(e)),...o])).slice(0,5);return{status:c?"healthy":"degraded",latency:i,modelsCount:o.length,sampleModels:h,requiredModelsAvailable:c,missingModels:l}}catch(e){return{status:"error",latency:Date.now()-t,message:e instanceof Error?e.message:String(e)}}finally{clearTimeout(a)}}let E=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/ai/health/route",pathname:"/api/ai/health",filename:"route",bundlePath:"app/api/ai/health/route"},resolvedPagePath:"C:\\Users\\raze0\\Documents\\vercel_deploy\\hylo00_original\\src\\app\\api\\ai\\health\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:f,staticGenerationAsyncStorage:v,serverHooks:y}=E,I="/api/ai/health/route";function m(){return(0,s.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:v})}},2584:(e,t,r)=>{r.d(t,{e:()=>n});var a=r(1202);let i=null;function n(){if(i)return i;try{return a.k.log(23,"Loading itinerary configuration","itinerary-config.ts","getItineraryConfig"),function(){let e=["GROQ_API_KEY","XAI_API_KEY","TAVILY_API_KEY","EXA_API_KEY","SERP_API_KEY","INNGEST_EVENT_KEY","INNGEST_SIGNING_KEY","KV_REST_API_URL","KV_REST_API_TOKEN"].filter(e=>!process.env[e]);if(e.length>0){let t=`Missing environment variables (using fallbacks): ${e.join(", ")}`;a.k.error(23,"Configuration validation failed","itinerary-config.ts","validateRequiredEnvVars",t)}else a.k.log(23,"Required environment variables validated","itinerary-config.ts","validateRequiredEnvVars")}(),i={groq:{apiKey:process.env.GROQ_API_KEY},xai:{apiKey:process.env.XAI_API_KEY},tavily:{apiKey:process.env.TAVILY_API_KEY},exa:{apiKey:process.env.EXA_API_KEY},serp:{apiKey:process.env.SERP_API_KEY},inngest:{eventKey:process.env.INNGEST_EVENT_KEY,signingKey:process.env.INNGEST_BRANCH_SIGNING_KEY||process.env.INNGEST_SIGNING_KEY},redis:{restUrl:process.env.KV_REST_API_URL,restToken:process.env.KV_REST_API_TOKEN},app:{nodeEnv:function(e){let t="development";return e&&["development","preview","production"].includes(e)?e:(a.k.warn(23,"Invalid NODE_ENV, using default","itinerary-config.ts","parseNodeEnv",`Invalid value: ${e}, using: ${t}`),t)}("production"),logLevel:function(e){let t="info";return e&&["silent","error","warn","info","debug"].includes(e)?e:(a.k.warn(23,"Invalid ITINERARY_LOG_LEVEL, using default","itinerary-config.ts","parseLogLevel",`Invalid value: ${e}, using: ${t}`),t)}(process.env.ITINERARY_LOG_LEVEL),cacheTtlMinutes:function(e){if(!e)return 120;let t=parseInt(e,10);return isNaN(t)||t<5||t>1440?(a.k.warn(23,"Invalid ITINERARY_CACHE_TTL_MINUTES, using default","itinerary-config.ts","parseCacheTtl",`Invalid value: ${e}, using: 120`),120):t}(process.env.ITINERARY_CACHE_TTL_MINUTES)},flags:{enableDetailedLogging:!0,enableDataCleansing:!0,allowPdfExport:!0,allowEmailDraft:!0,mapsFallbackMode:function(e){let t="static";return e&&["static","placeholder","hidden"].includes(e)?e:(a.k.warn(23,"Invalid maps fallback mode, using default","itinerary-config.ts","parseMapsFallbackMode",`Invalid value: ${e}, using: ${t}`),t)}(process.env.ITINERARY_MAPS_FALLBACK_MODE)}},a.k.log(23,"Itinerary configuration loaded successfully","itinerary-config.ts","getItineraryConfig",{nodeEnv:i.app.nodeEnv,logLevel:i.app.logLevel,cacheTtlMinutes:i.app.cacheTtlMinutes,mapsFallbackMode:i.flags.mapsFallbackMode}),i}catch(e){throw a.k.error(23,"Failed to load itinerary configuration","itinerary-config.ts","getItineraryConfig",e instanceof Error?e:String(e)),e}}},1202:(e,t,r)=>{var a,i,n,s,o;r.d(t,{k:()=>c}),function(e){e.USD="USD",e.EUR="EUR",e.GBP="GBP",e.CAD="CAD",e.AUD="AUD"}(a||(a={})),function(e){e.TOTAL="total",e.PER_PERSON="per-person"}(i||(i={})),function(e){e.PENDING="pending",e.PROCESSING="processing",e.COMPLETE="complete",e.ERROR="error"}(n||(n={})),function(e){e.SUCCESS="Success",e.ERROR="Error",e.WARNING="Warning"}(s||(s={})),function(e){e.HIGH="High",e.MEDIUM="Medium",e.LOW="Low"}(o||(o={}));class l{static instance;logLevel;logs=[];maxLogs=1e3;constructor(){this.logLevel=process.env.ITINERARY_LOG_LEVEL||"info"}static getInstance(){return l.instance||(l.instance=new l),l.instance}shouldLog(e){let t=["silent","error","warn","info","debug"],r=t.indexOf(this.logLevel);return t.indexOf(e)<=r}log(e,t,r,a,i={},n,o=s.SUCCESS){if(!this.shouldLog("info"))return;let l={stepNumber:e,action:t,fileName:r,functionName:a,timestamp:new Date().toISOString(),data:i,...void 0!==n&&{duration:n},status:o};this.logs.push(l),this.logs.length>this.maxLogs&&this.logs.shift();try{console.log(`Step ${e}: ${t} in ${r} - ${a}`,l)}catch(r){console.error(`Step ${e}: Logging failed for ${t}`,{error:r instanceof Error?r.message:String(r)})}}error(e,t,r,a,i,n={}){if(!this.shouldLog("error"))return;let o=i instanceof Error?i.message:i;this.log(e,t,r,a,{...n,error:o},void 0,s.ERROR)}warn(e,t,r,a,i,n={}){this.shouldLog("warn")&&this.log(e,t,r,a,{...n,warning:i},void 0,s.WARNING)}debug(e,t,r,a,i={}){this.shouldLog("debug")&&this.log(e,`DEBUG: ${t}`,r,a,i,void 0,s.SUCCESS)}getLogs(){return[...this.logs]}clearLogs(){this.logs=[]}}let c=l.getInstance()}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[948,972],()=>r(578));module.exports=a})();